<?php
require_once 'vendor/autoload.php'; require_once __DIR__ . '/../flight/autoload.php'; class RedirectTest extends PHPUnit_Framework_TestCase { private $app; function getBaseUrl($sp36644c, $sp00ca70) { if ($sp36644c != '/' && strpos($sp00ca70, '://') === false) { $sp00ca70 = preg_replace('#/+#', '/', $sp36644c . '/' . $sp00ca70); } return $sp00ca70; } function setUp() { $_SERVER['SCRIPT_NAME'] = '/subdir/index.php'; $this->app = new \flight\Engine(); $this->app->set('flight.base_url', '/testdir'); } function testBase() { $sp36644c = $this->app->request()->base; $this->assertEquals('/subdir', $sp36644c); } function testAbsoluteUrl() { $sp00ca70 = '/login'; $sp36644c = $this->app->request()->base; $this->assertEquals('/subdir/login', $this->getBaseUrl($sp36644c, $sp00ca70)); } function testRelativeUrl() { $sp00ca70 = 'login'; $sp36644c = $this->app->request()->base; $this->assertEquals('/subdir/login', $this->getBaseUrl($sp36644c, $sp00ca70)); } function testHttpUrl() { $sp00ca70 = 'http://www.yahoo.com'; $sp36644c = $this->app->request()->base; $this->assertEquals('http://www.yahoo.com', $this->getBaseUrl($sp36644c, $sp00ca70)); } function testBaseOverride() { $sp00ca70 = 'login'; if ($this->app->get('flight.base_url') !== null) { $sp36644c = $this->app->get('flight.base_url'); } else { $sp36644c = $this->app->request()->base; } $this->assertEquals('/testdir/login', $this->getBaseUrl($sp36644c, $sp00ca70)); } }